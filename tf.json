{"format_version":"1.1","terraform_version":"1.4.6","variables":{"additional_tags":{"value":{}},"associate_public_ip_address":{"value":true},"assume_role":{"value":null},"availability_zone":{"value":null},"aws_region":{"value":"ap-southeast-1"},"bootstrap_options":{"value":[]},"cpu_core_count":{"value":null},"cpu_threads_per_core":{"value":null},"create_dns":{"value":false},"create_ec2":{"value":true},"create_iam_instance_profile":{"value":false},"create_security_group":{"value":true},"custom_policy":{"value":null},"disable_api_termination":{"value":null},"dns_zone_id":{"value":null},"dns_zone_ttl":{"value":60},"ebs_block_device_mappings":{"value":[]},"ebs_optimized":{"value":null},"enclave_options_enabled":{"value":null},"ephemeral_block_device":{"value":[]},"get_password_data":{"value":null},"hibernation":{"value":null},"iam_instance_profile_name":{"value":null},"iam_role_description":{"value":null},"iam_role_path":{"value":null},"iam_role_permissions_boundary":{"value":null},"iam_role_policies":{"value":{}},"iam_role_tags":{"value":{}},"image_id":{"value":"ami-05b2dbde43603d503"},"instance_count":{"value":2},"instance_initiated_shutdown_behavior":{"value":null},"instance_name":{"value":"bastion"},"instance_type":{"value":"t4g.small"},"key_name":{"value":"bastion"},"launch_template":{"value":null},"master_prefix":{"value":"dev"},"metadata_options":{"value":{}},"monitoring":{"value":false},"network_interface":{"value":[]},"placement_group":{"value":null},"private_ip":{"value":[]},"record_name":{"value":null},"root_block_device_mappings":{"value":[{"encrypted":true,"kms_key_id":null,"volume_size":30,"volume_type":"gp3"}]},"security_group_name":{"value":null},"security_groups":{"value":{"internal":{"rules":{"all_outbound":{"cidr_blocks":["0.0.0.0/0"],"description":"Permit All traffic outbound","from_port":"0","protocol":"-1","to_port":"0","type":"egress"},"health_probe":{"cidr_blocks":["0.0.0.0/0","0.0.0.0/0"],"description":"Permit Port 22","from_port":"22","protocol":"tcp","to_port":"22","type":"ingress"}}}}},"subnet_ids":{"value":["subnet-112233b","subnet-778855d"]},"tags":{"value":{}},"timeouts":{"value":{"create":"10m","delete":"10m","update":"10m"}},"user_data":{"value":"#! /bin/bash\nsudo apt-get update\nsudo apt-get install -y apache2\nsudo systemctl start apache2\nsudo systemctl enable apache2\nexport AWS_ACCESS_KEY_ID\nexport AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE\nexport AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\nexport AWS_DEFAULT_REGION=us-west-2\necho \"\u003ch1\u003eDeployed via Terraform\u003c/h1\u003e\" | sudo tee /var/www/html/index.html\n"},"user_data_base64":{"value":null},"vpc_id":{"value":"vpc-123456abcdf"},"vpc_security_group_ids":{"value":[]}},"planned_values":{"outputs":{"iam_instance_profile_id":{"sensitive":false,"type":"dynamic","value":null},"iam_role_arn":{"sensitive":false,"type":"dynamic","value":null},"iam_role_name":{"sensitive":false,"type":"dynamic","value":null},"instance_id":{"sensitive":false},"instance_subnet_id":{"sensitive":false,"type":["object",{"0":"string","1":"string"}],"value":{"0":"subnet-112233b","1":"subnet-778855d"}},"private_ip":{"sensitive":false},"public_ip":{"sensitive":false},"security_group_id":{"sensitive":false}},"root_module":{"resources":[{"address":"aws_instance.ec2_instance[0]","mode":"managed","type":"aws_instance","name":"ec2_instance","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"ami":"ami-05b2dbde43603d503","associate_public_ip_address":true,"credit_specification":[],"enclave_options":[{}],"get_password_data":false,"hibernation":null,"instance_type":"t4g.small","key_name":"bastion","launch_template":[],"metadata_options":[{"http_endpoint":"enabled","http_put_response_hop_limit":1,"http_tokens":"optional"}],"monitoring":false,"root_block_device":[{"delete_on_termination":true,"encrypted":true,"tags":{"Name":"dev-bastion-1"},"volume_size":30,"volume_type":"gp3"}],"source_dest_check":true,"subnet_id":"subnet-112233b","tags":{"Name":"dev-bastion-1"},"tags_all":{"Name":"dev-bastion-1"},"timeouts":{"create":"10m","delete":"10m","update":"10m"},"user_data":"662cf2ca124eaabb7cb7ee17d07495fa782d676d","user_data_replace_on_change":false,"volume_tags":null},"sensitive_values":{"capacity_reservation_specification":[],"cpu_options":[],"credit_specification":[],"ebs_block_device":[],"enclave_options":[{}],"ephemeral_block_device":[],"ipv6_addresses":[],"launch_template":[],"maintenance_options":[],"metadata_options":[{}],"network_interface":[],"private_dns_name_options":[],"root_block_device":[{"tags":{}}],"secondary_private_ips":[],"security_groups":[],"tags":{},"tags_all":{},"timeouts":{},"vpc_security_group_ids":[]}},{"address":"aws_instance.ec2_instance[1]","mode":"managed","type":"aws_instance","name":"ec2_instance","index":1,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"ami":"ami-05b2dbde43603d503","associate_public_ip_address":true,"credit_specification":[],"enclave_options":[{}],"get_password_data":false,"hibernation":null,"instance_type":"t4g.small","key_name":"bastion","launch_template":[],"metadata_options":[{"http_endpoint":"enabled","http_put_response_hop_limit":1,"http_tokens":"optional"}],"monitoring":false,"root_block_device":[{"delete_on_termination":true,"encrypted":true,"tags":{"Name":"dev-bastion-2"},"volume_size":30,"volume_type":"gp3"}],"source_dest_check":true,"subnet_id":"subnet-778855d","tags":{"Name":"dev-bastion-2"},"tags_all":{"Name":"dev-bastion-2"},"timeouts":{"create":"10m","delete":"10m","update":"10m"},"user_data":"662cf2ca124eaabb7cb7ee17d07495fa782d676d","user_data_replace_on_change":false,"volume_tags":null},"sensitive_values":{"capacity_reservation_specification":[],"cpu_options":[],"credit_specification":[],"ebs_block_device":[],"enclave_options":[{}],"ephemeral_block_device":[],"ipv6_addresses":[],"launch_template":[],"maintenance_options":[],"metadata_options":[{}],"network_interface":[],"private_dns_name_options":[],"root_block_device":[{"tags":{}}],"secondary_private_ips":[],"security_groups":[],"tags":{},"tags_all":{},"timeouts":{},"vpc_security_group_ids":[]}},{"address":"aws_security_group.security_group[\"internal\"]","mode":"managed","type":"aws_security_group","name":"security_group","index":"internal","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"Managed by Terraform","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"Permit All traffic outbound","from_port":0,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"-1","security_groups":[],"self":false,"to_port":0}],"ingress":[{"cidr_blocks":["0.0.0.0/0","0.0.0.0/0"],"description":"Permit Port 22","from_port":22,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":22}],"name":"dev-bastion-ec2-internal-sg","revoke_rules_on_delete":false,"tags":{"Name":"dev-bastion-internal-sg"},"tags_all":{"Name":"dev-bastion-internal-sg"},"timeouts":null,"vpc_id":"vpc-123456abcdf"},"sensitive_values":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"ingress":[{"cidr_blocks":[false,false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"tags":{},"tags_all":{}}}]}},"resource_changes":[{"address":"aws_instance.ec2_instance[0]","mode":"managed","type":"aws_instance","name":"ec2_instance","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"ami":"ami-05b2dbde43603d503","associate_public_ip_address":true,"credit_specification":[],"enclave_options":[{}],"get_password_data":false,"hibernation":null,"instance_type":"t4g.small","key_name":"bastion","launch_template":[],"metadata_options":[{"http_endpoint":"enabled","http_put_response_hop_limit":1,"http_tokens":"optional"}],"monitoring":false,"root_block_device":[{"delete_on_termination":true,"encrypted":true,"tags":{"Name":"dev-bastion-1"},"volume_size":30,"volume_type":"gp3"}],"source_dest_check":true,"subnet_id":"subnet-112233b","tags":{"Name":"dev-bastion-1"},"tags_all":{"Name":"dev-bastion-1"},"timeouts":{"create":"10m","delete":"10m","update":"10m"},"user_data":"662cf2ca124eaabb7cb7ee17d07495fa782d676d","user_data_replace_on_change":false,"volume_tags":null},"after_unknown":{"arn":true,"availability_zone":true,"capacity_reservation_specification":true,"cpu_core_count":true,"cpu_options":true,"cpu_threads_per_core":true,"credit_specification":[],"disable_api_stop":true,"disable_api_termination":true,"ebs_block_device":true,"ebs_optimized":true,"enclave_options":[{"enabled":true}],"ephemeral_block_device":true,"host_id":true,"host_resource_group_arn":true,"iam_instance_profile":true,"id":true,"instance_initiated_shutdown_behavior":true,"instance_state":true,"ipv6_address_count":true,"ipv6_addresses":true,"launch_template":[],"maintenance_options":true,"metadata_options":[{"instance_metadata_tags":true}],"network_interface":true,"outpost_arn":true,"password_data":true,"placement_group":true,"placement_partition_number":true,"primary_network_interface_id":true,"private_dns":true,"private_dns_name_options":true,"private_ip":true,"public_dns":true,"public_ip":true,"root_block_device":[{"device_name":true,"iops":true,"kms_key_id":true,"tags":{},"throughput":true,"volume_id":true}],"secondary_private_ips":true,"security_groups":true,"tags":{},"tags_all":{},"tenancy":true,"timeouts":{},"user_data_base64":true,"vpc_security_group_ids":true},"before_sensitive":false,"after_sensitive":{"capacity_reservation_specification":[],"cpu_options":[],"credit_specification":[],"ebs_block_device":[],"enclave_options":[{}],"ephemeral_block_device":[],"ipv6_addresses":[],"launch_template":[],"maintenance_options":[],"metadata_options":[{}],"network_interface":[],"private_dns_name_options":[],"root_block_device":[{"tags":{}}],"secondary_private_ips":[],"security_groups":[],"tags":{},"tags_all":{},"timeouts":{},"vpc_security_group_ids":[]}}},{"address":"aws_instance.ec2_instance[1]","mode":"managed","type":"aws_instance","name":"ec2_instance","index":1,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"ami":"ami-05b2dbde43603d503","associate_public_ip_address":true,"credit_specification":[],"enclave_options":[{}],"get_password_data":false,"hibernation":null,"instance_type":"t4g.small","key_name":"bastion","launch_template":[],"metadata_options":[{"http_endpoint":"enabled","http_put_response_hop_limit":1,"http_tokens":"optional"}],"monitoring":false,"root_block_device":[{"delete_on_termination":true,"encrypted":true,"tags":{"Name":"dev-bastion-2"},"volume_size":30,"volume_type":"gp3"}],"source_dest_check":true,"subnet_id":"subnet-778855d","tags":{"Name":"dev-bastion-2"},"tags_all":{"Name":"dev-bastion-2"},"timeouts":{"create":"10m","delete":"10m","update":"10m"},"user_data":"662cf2ca124eaabb7cb7ee17d07495fa782d676d","user_data_replace_on_change":false,"volume_tags":null},"after_unknown":{"arn":true,"availability_zone":true,"capacity_reservation_specification":true,"cpu_core_count":true,"cpu_options":true,"cpu_threads_per_core":true,"credit_specification":[],"disable_api_stop":true,"disable_api_termination":true,"ebs_block_device":true,"ebs_optimized":true,"enclave_options":[{"enabled":true}],"ephemeral_block_device":true,"host_id":true,"host_resource_group_arn":true,"iam_instance_profile":true,"id":true,"instance_initiated_shutdown_behavior":true,"instance_state":true,"ipv6_address_count":true,"ipv6_addresses":true,"launch_template":[],"maintenance_options":true,"metadata_options":[{"instance_metadata_tags":true}],"network_interface":true,"outpost_arn":true,"password_data":true,"placement_group":true,"placement_partition_number":true,"primary_network_interface_id":true,"private_dns":true,"private_dns_name_options":true,"private_ip":true,"public_dns":true,"public_ip":true,"root_block_device":[{"device_name":true,"iops":true,"kms_key_id":true,"tags":{},"throughput":true,"volume_id":true}],"secondary_private_ips":true,"security_groups":true,"tags":{},"tags_all":{},"tenancy":true,"timeouts":{},"user_data_base64":true,"vpc_security_group_ids":true},"before_sensitive":false,"after_sensitive":{"capacity_reservation_specification":[],"cpu_options":[],"credit_specification":[],"ebs_block_device":[],"enclave_options":[{}],"ephemeral_block_device":[],"ipv6_addresses":[],"launch_template":[],"maintenance_options":[],"metadata_options":[{}],"network_interface":[],"private_dns_name_options":[],"root_block_device":[{"tags":{}}],"secondary_private_ips":[],"security_groups":[],"tags":{},"tags_all":{},"timeouts":{},"vpc_security_group_ids":[]}}},{"address":"aws_security_group.security_group[\"internal\"]","mode":"managed","type":"aws_security_group","name":"security_group","index":"internal","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Managed by Terraform","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"Permit All traffic outbound","from_port":0,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"-1","security_groups":[],"self":false,"to_port":0}],"ingress":[{"cidr_blocks":["0.0.0.0/0","0.0.0.0/0"],"description":"Permit Port 22","from_port":22,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":22}],"name":"dev-bastion-ec2-internal-sg","revoke_rules_on_delete":false,"tags":{"Name":"dev-bastion-internal-sg"},"tags_all":{"Name":"dev-bastion-internal-sg"},"timeouts":null,"vpc_id":"vpc-123456abcdf"},"after_unknown":{"arn":true,"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"id":true,"ingress":[{"cidr_blocks":[false,false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"name_prefix":true,"owner_id":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"ingress":[{"cidr_blocks":[false,false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"tags":{},"tags_all":{}}}}],"output_changes":{"iam_instance_profile_id":{"actions":["no-op"],"before":null,"after":null,"after_unknown":false,"before_sensitive":false,"after_sensitive":false},"iam_role_arn":{"actions":["no-op"],"before":null,"after":null,"after_unknown":false,"before_sensitive":false,"after_sensitive":false},"iam_role_name":{"actions":["no-op"],"before":null,"after":null,"after_unknown":false,"before_sensitive":false,"after_sensitive":false},"instance_id":{"actions":["create"],"before":null,"after":{},"after_unknown":{"0":true,"1":true},"before_sensitive":false,"after_sensitive":false},"instance_subnet_id":{"actions":["create"],"before":null,"after":{"0":"subnet-112233b","1":"subnet-778855d"},"after_unknown":false,"before_sensitive":false,"after_sensitive":false},"private_ip":{"actions":["create"],"before":null,"after":{},"after_unknown":{"0":true,"1":true},"before_sensitive":false,"after_sensitive":false},"public_ip":{"actions":["create"],"before":null,"after":{},"after_unknown":{"0":true,"1":true},"before_sensitive":false,"after_sensitive":false},"security_group_id":{"actions":["create"],"before":null,"after":{},"after_unknown":{"internal":true},"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.4.6","values":{"outputs":{"instance_subnet_id":{"sensitive":false,"value":{"0":"subnet-112233b","1":"subnet-778855d"},"type":["object",{"0":"string","1":"string"}]}},"root_module":{"resources":[{"address":"data.aws_partition.current","mode":"data","type":"aws_partition","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"dns_suffix":"amazonaws.com","id":"aws","partition":"aws","reverse_dns_prefix":"com.amazonaws"},"sensitive_values":{}}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws","version_constraint":"~\u003e 5.1.0","expressions":{"default_tags":[{"tags":{"references":["var.tags"]}}],"region":{"references":["var.aws_region"]}}}},"root_module":{"outputs":{"iam_instance_profile_id":{"expression":{"references":["aws_iam_instance_profile.instance_profile[0].id","aws_iam_instance_profile.instance_profile[0]","aws_iam_instance_profile.instance_profile"]},"description":"Instance profile's ID"},"iam_role_arn":{"expression":{"references":["aws_iam_role.instance_profile[0].arn","aws_iam_role.instance_profile[0]","aws_iam_role.instance_profile"]},"description":"The Amazon Resource Name (ARN) specifying the IAM role"},"iam_role_name":{"expression":{"references":["aws_iam_role.instance_profile[0].name","aws_iam_role.instance_profile[0]","aws_iam_role.instance_profile"]},"description":"The name of the IAM role"},"instance_id":{"expression":{"references":["aws_instance.ec2_instance"]},"description":"List IDs of instances"},"instance_subnet_id":{"expression":{"references":["aws_instance.ec2_instance"]},"description":"List VPC subnets Ids of instances"},"private_ip":{"expression":{"references":["aws_instance.ec2_instance"]},"description":"List of private IP addresses assigned to the instances"},"public_ip":{"expression":{"references":["aws_instance.ec2_instance"]},"description":"List of public IP addresses assigned to the instances, if applicable"},"security_group_id":{"expression":{"references":["aws_security_group.security_group"]},"description":"ID of the security group"}},"resources":[{"address":"aws_iam_instance_profile.instance_profile","mode":"managed","type":"aws_iam_instance_profile","name":"instance_profile","provider_config_key":"aws","expressions":{"name":{"references":["local.internal_iam_instance_profile_name"]},"path":{"references":["var.iam_role_path"]},"role":{"references":["aws_iam_role.instance_profile[0].name","aws_iam_role.instance_profile[0]","aws_iam_role.instance_profile"]},"tags":{"references":["var.iam_role_tags"]}},"schema_version":0,"count_expression":{"references":["local.create","var.create_iam_instance_profile"]}},{"address":"aws_iam_policy.custom_policy","mode":"managed","type":"aws_iam_policy","name":"custom_policy","provider_config_key":"aws","expressions":{"name":{"references":["var.master_prefix","var.instance_name"]},"policy":{"references":["var.custom_policy"]}},"schema_version":0,"count_expression":{"references":["local.create","var.create_iam_instance_profile","var.custom_policy"]}},{"address":"aws_iam_role.instance_profile","mode":"managed","type":"aws_iam_role","name":"instance_profile","provider_config_key":"aws","expressions":{"assume_role_policy":{"references":["data.aws_iam_policy_document.assume_role_policy[0].json","data.aws_iam_policy_document.assume_role_policy[0]","data.aws_iam_policy_document.assume_role_policy"]},"description":{"references":["var.iam_role_description"]},"force_detach_policies":{"constant_value":true},"name":{"references":["local.internal_iam_instance_profile_name"]},"path":{"references":["var.iam_role_path"]},"permissions_boundary":{"references":["var.iam_role_permissions_boundary"]},"tags":{"references":["var.iam_role_tags"]}},"schema_version":0,"count_expression":{"references":["local.create","var.create_iam_instance_profile"]}},{"address":"aws_iam_role_policy_attachment.custom_policy_attachment","mode":"managed","type":"aws_iam_role_policy_attachment","name":"custom_policy_attachment","provider_config_key":"aws","expressions":{"policy_arn":{"references":["aws_iam_policy.custom_policy[0].arn","aws_iam_policy.custom_policy[0]","aws_iam_policy.custom_policy"]},"role":{"references":["aws_iam_role.instance_profile[0].name","aws_iam_role.instance_profile[0]","aws_iam_role.instance_profile"]}},"schema_version":0,"count_expression":{"references":["local.create","var.create_iam_instance_profile","var.custom_policy"]}},{"address":"aws_iam_role_policy_attachment.policy_attachment","mode":"managed","type":"aws_iam_role_policy_attachment","name":"policy_attachment","provider_config_key":"aws","expressions":{"policy_arn":{"references":["each.value"]},"role":{"references":["aws_iam_role.instance_profile[0].name","aws_iam_role.instance_profile[0]","aws_iam_role.instance_profile"]}},"schema_version":0,"for_each_expression":{"references":["var.iam_role_policies","local.create","var.create_iam_instance_profile"]}},{"address":"aws_instance.ec2_instance","mode":"managed","type":"aws_instance","name":"ec2_instance","provider_config_key":"aws","expressions":{"ami":{"references":["var.image_id"]},"associate_public_ip_address":{"references":["var.associate_public_ip_address"]},"availability_zone":{"references":["var.availability_zone"]},"cpu_core_count":{"references":["var.cpu_core_count"]},"cpu_threads_per_core":{"references":["var.cpu_threads_per_core"]},"disable_api_termination":{"references":["var.disable_api_termination"]},"ebs_optimized":{"references":["var.ebs_optimized"]},"enclave_options":[{"enabled":{"references":["var.enclave_options_enabled"]}}],"get_password_data":{"references":["var.get_password_data"]},"hibernation":{"references":["var.hibernation"]},"iam_instance_profile":{"references":["local.iam_instance_profile_name"]},"instance_initiated_shutdown_behavior":{"references":["var.instance_initiated_shutdown_behavior"]},"instance_type":{"references":["var.instance_type"]},"key_name":{"references":["var.key_name"]},"monitoring":{"references":["var.monitoring"]},"placement_group":{"references":["var.placement_group"]},"private_ip":{"references":["var.private_ip","var.instance_count","var.private_ip","count.index"]},"subnet_id":{"references":["var.subnet_ids","var.subnet_ids","count.index"]},"tags":{"references":["var.additional_tags","var.master_prefix","var.instance_name","count.index"]},"timeouts":{"create":{"references":["var.timeouts.create","var.timeouts"]},"delete":{"references":["var.timeouts.delete","var.timeouts"]},"update":{"references":["var.timeouts.update","var.timeouts"]}},"user_data":{"references":["var.user_data","var.user_data","local.user_data"]},"user_data_base64":{"references":["var.user_data_base64"]},"vpc_security_group_ids":{"references":["var.vpc_security_group_ids","aws_security_group.security_group"]}},"schema_version":1,"count_expression":{"references":["local.create","var.instance_count"]}},{"address":"aws_security_group.security_group","mode":"managed","type":"aws_security_group","name":"security_group","provider_config_key":"aws","expressions":{"name":{"references":["var.master_prefix","local.security_group_name","each.key"]},"tags":{"references":["var.tags","var.master_prefix","var.instance_name","each.key"]},"vpc_id":{"references":["var.vpc_id"]}},"schema_version":1,"for_each_expression":{"references":["local.create_security_group","var.security_groups"]}},{"address":"data.aws_iam_policy_document.assume_role_policy","mode":"data","type":"aws_iam_policy_document","name":"assume_role_policy","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["sts:AssumeRole"]},"principals":[{"identifiers":{"references":["data.aws_partition.current.dns_suffix","data.aws_partition.current"]},"type":{"constant_value":"Service"}}],"sid":{"constant_value":"EC2AssumeRole"}}]},"schema_version":0,"count_expression":{"references":["local.create","var.create_iam_instance_profile"]}},{"address":"data.aws_partition.current","mode":"data","type":"aws_partition","name":"current","provider_config_key":"aws","schema_version":0}],"variables":{"additional_tags":{"default":{},"description":"Tags to add to the security group resource."},"associate_public_ip_address":{"default":false,"description":"Associate a public IP address with the instance"},"assume_role":{"default":null,"description":"AssumeRole to manage the resources within account that owns"},"availability_zone":{"default":null,"description":"AZ to start the instance in"},"aws_region":{"default":"ap-southeast-1","description":"AWS Region name to deploy resources."},"bootstrap_options":{"default":[],"description":"Bootstrap options to put into userdata"},"cpu_core_count":{"default":null,"description":"Sets the number of CPU cores for an instance."},"cpu_threads_per_core":{"default":null,"description":"Sets the number of CPU threads per core for an instance (has no effect unless cpu_core_count is also set)."},"create_dns":{"default":false,"description":"A boolean flag to add record to route53"},"create_ec2":{"default":true,"description":"A boolean flag to create EC2 instance"},"create_iam_instance_profile":{"default":false,"description":"Determines whether an IAM instance profile is created or to use an existing IAM instance profile"},"create_security_group":{"default":true,"description":"A boolean flag to determine whether to create Security Group."},"custom_policy":{"default":null,"description":"The policy document. This is a JSON formatted string."},"disable_api_termination":{"default":null,"description":"If true, enables EC2 Instance Termination Protection"},"dns_zone_id":{"default":null,"description":"Route53 DNS Zone ID."},"dns_zone_ttl":{"default":60,"description":"The TTL of the record."},"ebs_block_device_mappings":{"default":[],"description":"Additional EBS block devices to attach to the instance"},"ebs_optimized":{"default":null,"description":"If true, the launched EC2 instance will be EBS-optimized"},"enclave_options_enabled":{"default":null,"description":"Whether Nitro Enclaves will be enabled on the instance. Defaults to `false`"},"ephemeral_block_device":{"default":[],"description":"Customize Ephemeral (also known as Instance Store) volumes on the instance"},"get_password_data":{"default":null,"description":"If true, wait for password data to become available and retrieve it."},"hibernation":{"default":null,"description":"If true, the launched EC2 instance will support hibernation"},"iam_instance_profile_name":{"default":null,"description":"The name of the IAM instance profile to be created (`create_iam_instance_profile` = `true`) or existing (`create_iam_instance_profile` = `false`)"},"iam_role_description":{"default":null,"description":"Description of the role"},"iam_role_path":{"default":null,"description":"IAM role path"},"iam_role_permissions_boundary":{"default":null,"description":"ARN of the policy that is used to set the permissions boundary for the IAM role"},"iam_role_policies":{"default":{},"description":"IAM policies to attach to the IAM role"},"iam_role_tags":{"default":{},"description":"A map of additional tags to add to the IAM role created"},"image_id":{"description":"The AMI to use for the instance."},"instance_count":{"default":1,"description":"Number of instance to deploy"},"instance_initiated_shutdown_behavior":{"default":null,"description":"Shutdown behavior for the instance. Amazon defaults this to stop for EBS-backed instances and terminate for instance-store instances. Cannot be set on instance-store instance"},"instance_name":{"default":null,"description":"Name to be used on EC2 instance created"},"instance_type":{"default":"t4g.micro","description":"The type of instance to start"},"key_name":{"description":"Key name of the Key Pair to use for the instance."},"launch_template":{"default":null,"description":"Specifies a Launch Template to configure the instance. Parameters configured on this resource will override the corresponding parameters in the Launch Template"},"master_prefix":{"default":"dso","description":"To specify a key prefix for aws resource"},"metadata_options":{"default":{},"description":"Customize the metadata options of the instance"},"monitoring":{"default":false,"description":"If true, the launched EC2 instance will have detailed monitoring enabled"},"network_interface":{"default":[],"description":"Customize network interfaces to be attached at instance boot time"},"placement_group":{"default":null,"description":"The Placement Group to start the instance in"},"private_ip":{"default":[],"description":"Private IP address to associate with the instance in the VPC"},"record_name":{"default":null,"description":"Name of the A record to create"},"root_block_device_mappings":{"default":[],"description":"Customize details about the root block device of the instance. See Block Devices below for details"},"security_group_name":{"default":null,"description":"Name of the security group."},"security_groups":{"default":null,"description":"  The `security_groups` variable is a map of maps, where each map represents an AWS Security Group.\r\n  The key of each entry acts as the Security Group name.\r\n  List of available attributes of each Security Group entry:\r\n  - `rules`: A list of objects representing a Security Group rule. The key of each entry acts as the name of the rule and\r\n      needs to be unique across all rules in the Security Group.\r\n      List of attributes available to define a Security Group rule:\r\n      - `description`: Security Group description.\r\n      - `type`: Specifies if rule will be evaluated on ingress (inbound) or egress (outbound) traffic.\r\n      - `cidr_blocks`: List of CIDR blocks - for ingress, determines the traffic that can reach your instance. For egress\r\n      Determines the traffic that can leave your instance, and where it can go.\r\n\r\n\r\n  Example:\r\n  ```\r\n  security_groups = {\r\n    mgmt = {\r\n      name = \"mgmt\"\r\n      rules = {\r\n        all-outbound = {\r\n          description = \"Permit All traffic outbound\"\r\n          type        = \"egress\", from_port = \"0\", to_port = \"0\", protocol = \"-1\"\r\n          cidr_blocks = [\"0.0.0.0/0\"]\r\n        }\r\n        https-inbound = {\r\n          description = \"Permit HTTPS\"\r\n          type        = \"ingress\", from_port = \"443\", to_port = \"443\", protocol = \"tcp\"\r\n          cidr_blocks = [\"10.0.0.0/8\"]\r\n        }\r\n        http-inbound = {\r\n          description = \"Permit HTTPS\"\r\n          type        = \"ingress\", from_port = \"80\", to_port = \"80\", protocol = \"tcp\"\r\n          cidr_blocks = [\"10.0.0.0/8\"]\r\n        }\r\n        ssh-inbound-eip = {\r\n          description = \"Permit SSH\"\r\n          type        = \"ingress\", from_port = \"22\", to_port = \"22\", protocol = \"tcp\"\r\n          cidr_blocks = [\"10.0.0.0/8\"]\r\n        }\r\n      }\r\n    }\r\n  }\r\n  ```\r\n"},"subnet_ids":{"default":[],"description":"A list of subnets to assign to EC2. e.g. ['subnet-1a2b3c4d','subnet-1a2b3c4e','subnet-1a2b3c4f']"},"tags":{"default":{},"description":"A map of tags to add to all resources."},"timeouts":{"default":{"create":"10m","delete":"10m","update":"10m"},"description":"Define maximum timeout for creating, updating, and deleting EC2 instance resources"},"user_data":{"default":null,"description":"Can be used instead of `user_data` to pass base64-encoded binary data directly. Use this instead of `user_data` whenever the value is not a valid UTF-8 string. For example, gzip-encoded user data must be base64-encoded and passed via this argument to avoid corruption"},"user_data_base64":{"default":null,"description":"Can be used instead of `user_data` to pass base64-encoded binary data directly. Use this instead of `user_data` whenever the value is not a valid UTF-8 string. For example, gzip-encoded user data must be base64-encoded and passed via this argument to avoid corruption"},"vpc_id":{"default":null,"description":"The VPC ID where Security Group will be created."},"vpc_security_group_ids":{"default":[],"description":"Additional security group IDs to apply to the cluster, in addition to the provisioned default security group with ingress traffic from existing CIDR blocks and existing security groups"}}}},"relevant_attributes":[{"resource":"aws_security_group.security_group","attribute":[]},{"resource":"aws_instance.ec2_instance","attribute":[]}]}
